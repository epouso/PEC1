---
title: "PEC1"
author: "Enrique Pouso-V√°zquez S√°nchez"
date: "2025-03-31"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

- Pregunta biol√≥gica? Reflexion sobre lo que queremos estudiar, definir tratamientos, tipos de variables.
- Tipo de estudio? Comparativo, buscamos diferencias entre los dos grupos a partir de biomarcadores (metabolitos en orina) para, de esta forma, poder determinar el estado de afectaci√≥n a diferentes organos de una persona usuaria de opioides.
- An√°lisis estad√≠stico exploratorio: 
Descriptivo, 
PCA: 
1)Comentar efecto batch, no se puede determinar porque no sabemos ni lotes ni cuando se ha hecho cada analisis pero que si se tubiera la info se podria estudiar.
2) Comentar posibles variables latentes
*Comentar que hacemos el pca con prcomp porque es m√°s eficiente en datos de alta dimensionalidad. Comentar que normalizamos los datos para que la escala de las variables no afecte al resultado del pca, de esta forma se evita que variables con mayor escala afecten m√°s al analisis y permite comparar de forma justa todas las variables.
Porque es importante el PCA en este estudio:
El PCA permite generar gr√°ficos de dispersi√≥n de las primeras dos o tres componentes principales (PC1 vs. PC2 o PC1 vs. PC2 vs. PC3), donde:
üîπ Se pueden detectar grupos naturales en los datos (e.g., diferencias entre individuos sanos vs. enfermos).
üîπ Se pueden identificar patrones metab√≥licos asociados a condiciones espec√≠ficas.
üîπ Se pueden encontrar outliers o muestras que se comportan de manera an√≥mala.
Cada componente principal es una combinaci√≥n de metabolitos con diferentes pesos (loadings).
üîπ Metabolitos con mayores pesos en PC1 o PC2 pueden ser clave en la diferenciaci√≥n de grupos.
üîπ Esto ayuda a seleccionar los metabolitos m√°s relevantes para biomarcadores potenciales.

Clustering (Busqueda de patrones)

En este caso se realizar√° un cluster jer√°rquico basado en distancias eucl√≠deas y enlaces promedio (‚Äúaverage linkage‚Äô‚Äô) (Como en el ejemplo). El m√©todo "average linkage" es un enfoque intermedio entre el "single" y el "complete", que puede ser √∫til cuando se busca un balance en la formaci√≥n de clusters

Ventajas
Produce clusters equilibrados y suaves. M√°s robusto a la forma de los clusters que "single linkage"
Desventajas
Menos sensible a outliers que "single linkage". Puede ser menos preciso con datos muy dispersos

Su objetivo es descubrir grupos en los datos, es decir grupos de individuos (o eventualmente de variables) que pueden considerarse m√°s similares entre ellos que a los individuos de los otros grupos.
Realizaremos un Clustering jer√°rquico debido a que no sabemos cuantos clusteres utilizar ( el K-means necesitas decidir cu√°ntos clusters quieres de antemano).

Seleccionar solo las variables (genes) que tienen una mayor variabilidad es una t√©cnica com√∫n para mejorar la interpretaci√≥n de los an√°lisis de clustering, ya que reduce el ruido y se enfoca en las caracter√≠sticas m√°s relevantes para distinguir entre los grupos. En este caso, seleccionar los genes con las desviaciones est√°ndar m√°s altas es una forma sencilla de capturar aquellos que var√≠an m√°s entre las observaciones.

EJEMPLO DE DISCUSI√ìN:

"El dendrograma generado con 336 observaciones muestra una clara divisi√≥n en dos grandes grupos, lo que sugiere que las muestras pueden agruparse en dos categor√≠as principales. Al cortar el dendrograma a una distancia de 10, identificamos dos clusters, uno de los cuales contiene principalmente muestras de pacientes usuarios de opioides, mientras que el otro agrupa a los pacientes no usuarios. Esta separaci√≥n podr√≠a reflejar diferencias metab√≥licas entre los dos grupos. Sin embargo, el tama√±o desigual de los clusters (con un grupo considerablemente mayor que el otro) puede indicar que m√°s an√°lisis son necesarios para explorar subgrupos dentro de estas categor√≠as. Los metabolitos seleccionados con alta variabilidad parecen ser relevantes para la separaci√≥n entre los grupos, y una futura validaci√≥n con datos adicionales podr√≠a confirmar estos hallazgos."
